<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Mobile Pulse</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0rc1/jquery.mobile-1.0rc1.min.css" />
<link rel="stylesheet" href="/css/styles.css">
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script>
  window.jQuery || document.write('<script src="/js/libs/jquery-1.6.4.min.js"><\/script>')
</script>
<script src="http://code.jquery.com/mobile/1.0rc1/jquery.mobile-1.0rc1.min.js"></script>
<script>
  window.jQuery.mobile || document.write('<script src="/js/libs/jquery.mobile-1.0rc1.min.js"><\/script>')
</script>
</head>
<body><div data-role="page" id="index" data-title="Mobile Pulse">
  <div data-role="header">
    <a href="#options" data-icon="gear">Options</a>
    <h1>Mobile Pulse</h1>
  </div>
  <div data-role="content">
    <ul data-role="listview">
      <li><a href="feedback.html" rel="external">Feedback</a></li>
      <li><a href="crashdetects.html" rel="external">Crash Detects</a></li>
      <li><a href="clientlogs.html" rel="external">Client Logs</a></li>
    </ul>
  </div>
</div>

<script>
  $('#options').live('pageshow', function() {
    $.mobile.showPageLoadingMsg();
    $.getJSON('/rest/mobileCarriers', function(carriers) {
      populateCarrierList(carriers);
      $.getJSON('/rest/users', function(user) {
        options(user);
        $.mobile.hidePageLoadingMsg();
      })
    });
  });

  function populateCarrierList(carriers) {
    var list = carriers['mobileCarriers'];
    var select = $('#carrier');
    select.html('');
    var markup = '';
    for (i = 0; i < list.length; i++) {
      markup += '<option value="' + list[i]['id'] + '">' + list[i]['name'] + '</option>';
    }
  }

  function options(data) {
    $('#options').find('form')[0].reset();
  }
</script>

<div data-role="dialog" id="options" data-title="Mobile Pulse Options" data-theme="b">
  <div data-role="header">
    <h1>Options</h1>
    </div>
    <div data-role="content">
      <form id="options_form">
        <div data-role="fieldcontain">
          <input type="checkbox" name="email" id="email"> <label for="email">Email Notifications?</label>
        </div>
        <fieldset>
        <legend>SMS Notificaitons</legend>
        <div data-role="fieldcontain">
          <input type="checkbox" name="sms" id="sms"> <label for="sms">Yes, please.</label>
          <div id="sms_details" style="display: none;">
            <input type="tel" name="phone_number" id="phone_number" placeholder="Phone Number" required>
            <select name="carrier" id="carrier">
            </select>
          </div>
        </div>
        </fieldset>
        <input type="submit" value="Save">
      </form>
    </div>
    <div data-role="footer">
      <div data-role="navbar">
        <ul>
          <li><a href="#index" data-rel="back" data-role="button">Cancel</a>
          </li>
        </ul>
      </div>
  </div>
</div>
</body>
</html>
